{
    "adapter_version": "0.4.0",
    "fallback_init_result": {
        "protocolVersion": "2024-11-05",
        "capabilities": {
            "tools": {
                "listChanged": false
            },
            "resources": {
                "listChanged": false,
                "subscribe": false,
                "subscribeSupported": false
            }
        },
        "serverInfo": {
            "name": "Ribir Debug Server",
            "version": "0.4.0",
            "description": "Debug and inspect running Ribir applications. Capture screenshots, explore widget tree, add visual overlays, view logs, and record frames."
        }
    },
    "tools": [
        {
            "name": "capture_screenshot",
            "description": "Capture a screenshot of the specified window. Returns the image as base64-encoded PNG data in the response.",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "window_id": {
                        "type": "string",
                        "description": "Window ID to capture (optional, defaults to primary)"
                    }
                }
            }
        },
        {
            "name": "inspect_tree",
            "description": "Get the full widget tree structure",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "window_id": {
                        "type": "string",
                        "description": "Window ID (optional)"
                    },
                    "options": {
                        "type": "string",
                        "description": "Filter what to show. Options: 'all' (everything), 'id' (WidgetId), 'layout' (pos+size), 'global_pos' (screen coords), 'clamp' (constraints), 'props' (properties). Prefix with 'no_' to exclude (e.g. 'all,no_props')."
                    }
                }
            }
        },
        {
            "name": "inspect_widget",
            "description": "Get details for a specific widget by ID",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "window_id": {
                        "type": "string",
                        "description": "Window ID (optional)"
                    },
                    "options": {
                        "type": "string",
                        "description": "Filter what to show. Options: 'all' (everything), 'id' (WidgetId), 'layout' (pos+size), 'global_pos' (screen coords), 'clamp' (constraints), 'props' (properties). Prefix with 'no_' to exclude (e.g. 'all,no_props')."
                    },
                    "id": {
                        "type": "string",
                        "description": "Widget ID to inspect"
                    }
                },
                "required": [
                    "id"
                ]
            }
        },
        {
            "name": "get_overlays",
            "description": "List all active overlays",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "window_id": {
                        "type": "string",
                        "description": "Window ID (optional)"
                    }
                }
            }
        },
        {
            "name": "set_log_filter",
            "description": "Set the log filter (e.g., 'info,ribir_core=debug')",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "filter": {
                        "type": "string",
                        "description": "Filter string"
                    }
                },
                "required": [
                    "filter"
                ]
            }
        },
        {
            "name": "add_overlay",
            "description": "Add a visual highlight overlay to a widget for debugging purposes",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "window_id": {
                        "type": "string",
                        "description": "Window ID (optional)"
                    },
                    "id": {
                        "type": "string",
                        "description": "Widget ID (e.g., '1', '1:0', or string ID)"
                    },
                    "color": {
                        "type": "string",
                        "description": "Color hex code (optional, #RRGGBB or #RRGGBBAA, default: #FF000080)"
                    }
                },
                "required": [
                    "id"
                ]
            }
        },
        {
            "name": "remove_overlay",
            "description": "Remove a specific visual debug overlay from a widget",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "window_id": {
                        "type": "string",
                        "description": "Window ID (optional)"
                    },
                    "id": {
                        "type": "string",
                        "description": "Widget ID of the overlay to remove"
                    }
                },
                "required": [
                    "id"
                ]
            }
        },
        {
            "name": "clear_overlays",
            "description": "Clear all visual debug overlays from the window",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "window_id": {
                        "type": "string",
                        "description": "Window ID (optional)"
                    }
                }
            }
        },
        {
            "name": "start_recording",
            "description": "Start recording frames to disk. Frames are saved as PNG files in the current working directory with pattern: frame_{timestamp}_{sequence}.png. Use RIBIR_CAPTURE_DIR env var to customize output location (defaults to ./captures/)",
            "inputSchema": {
                "type": "object",
                "properties": {}
            }
        },
        {
            "name": "stop_recording",
            "description": "Stop recording and return the capture directory path. Use RIBIR_CAPTURE_DIR env var to customize output location (defaults to ./captures/)",
            "inputSchema": {
                "type": "object",
                "properties": {}
            }
        },
        {
            "name": "capture_one_shot",
            "description": "One-click capture: start -> request redraw (if images enabled) -> wait -> stop. Returns the capture session directory path. Default output directory is $RIBIR_CAPTURE_DIR or ./captures/{capture_id}/, containing frames/*.png, logs.jsonl and manifest.json",
            "inputSchema": {
                "type": "object",
                "properties": {
                    "include": {
                        "type": "array",
                        "items": {
                            "type": "string",
                            "enum": [
                                "logs",
                                "images"
                            ]
                        },
                        "description": "What to include in the capture (e.g. ['logs', 'images'])"
                    },
                    "pre_ms": {
                        "type": "integer",
                        "description": "Ms of logs to include prior to start (default 2000)"
                    },
                    "post_ms": {
                        "type": "integer",
                        "description": "Ms of logs to include after stop (default 1000)"
                    },
                    "settle_ms": {
                        "type": "integer",
                        "description": "Extra time (ms) to wait after we observe a frame update (default 150)"
                    },
                    "output_dir": {
                        "type": "string",
                        "description": "Optional output directory"
                    }
                },
                "required": [
                    "include"
                ]
            }
        }
    ],
    "resources": [
        {
            "uri": "ribir://logs",
            "name": "Application Logs",
            "description": "Recent application logs (last 100 lines). Access via resources/read method with the given URI",
            "mimeType": "text/plain"
        },
        {
            "uri": "ribir://windows",
            "name": "Window List",
            "description": "List of active windows. Access via resources/read method with the given URI",
            "mimeType": "application/json"
        },
        {
            "uri": "ribir://status",
            "name": "Server Status",
            "description": "Debug server status (recording, filter, stats). Access via resources/read method with the given URI",
            "mimeType": "application/json"
        }
    ]
}